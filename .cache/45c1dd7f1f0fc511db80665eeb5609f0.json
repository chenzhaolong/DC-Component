{"dependencies":[{"name":"babel-runtime/helpers/extends","loc":{"line":1,"column":21}},{"name":"babel-runtime/helpers/classCallCheck","loc":{"line":2,"column":28}},{"name":"babel-runtime/helpers/possibleConstructorReturn","loc":{"line":3,"column":39}},{"name":"babel-runtime/helpers/inherits","loc":{"line":4,"column":22}},{"name":"react","loc":{"line":5,"column":18}},{"name":"react-dom","loc":{"line":6,"column":21}},{"name":"rc-util/es/KeyCode","loc":{"line":7,"column":20}},{"name":"rc-animate","loc":{"line":8,"column":20}},{"name":"./LazyRenderBox","loc":{"line":9,"column":26}},{"name":"rc-util/es/getScrollBarSize","loc":{"line":10,"column":29}},{"name":"object-assign","loc":{"line":11,"column":19}}],"generated":{"js":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends2 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _possibleConstructorReturn2 = require(\"babel-runtime/helpers/possibleConstructorReturn\");\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require(\"babel-runtime/helpers/inherits\");\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactDom = require(\"react-dom\");\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _KeyCode = require(\"rc-util/es/KeyCode\");\n\nvar _KeyCode2 = _interopRequireDefault(_KeyCode);\n\nvar _rcAnimate = require(\"rc-animate\");\n\nvar _rcAnimate2 = _interopRequireDefault(_rcAnimate);\n\nvar _LazyRenderBox = require(\"./LazyRenderBox\");\n\nvar _LazyRenderBox2 = _interopRequireDefault(_LazyRenderBox);\n\nvar _getScrollBarSize = require(\"rc-util/es/getScrollBarSize\");\n\nvar _getScrollBarSize2 = _interopRequireDefault(_getScrollBarSize);\n\nvar _objectAssign = require(\"object-assign\");\n\nvar _objectAssign2 = _interopRequireDefault(_objectAssign);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar uuid = 0;\nvar openCount = 0;\n/* eslint react/no-is-mounted:0 */\nfunction getScroll(w, top) {\n  var ret = w['page' + (top ? 'Y' : 'X') + 'Offset'];\n  var method = 'scroll' + (top ? 'Top' : 'Left');\n  if (typeof ret !== 'number') {\n    var d = w.document;\n    ret = d.documentElement[method];\n    if (typeof ret !== 'number') {\n      ret = d.body[method];\n    }\n  }\n  return ret;\n}\nfunction setTransformOrigin(node, value) {\n  var style = node.style;\n  ['Webkit', 'Moz', 'Ms', 'ms'].forEach(function (prefix) {\n    style[prefix + 'TransformOrigin'] = value;\n  });\n  style['transformOrigin'] = value;\n}\nfunction offset(el) {\n  var rect = el.getBoundingClientRect();\n  var pos = {\n    left: rect.left,\n    top: rect.top\n  };\n  var doc = el.ownerDocument;\n  var w = doc.defaultView || doc.parentWindow;\n  pos.left += getScroll(w);\n  pos.top += getScroll(w, true);\n  return pos;\n}\n\nvar Dialog = function (_React$Component) {\n  (0, _inherits3.default)(Dialog, _React$Component);\n\n  function Dialog() {\n    (0, _classCallCheck3.default)(this, Dialog);\n\n    var _this = (0, _possibleConstructorReturn3.default)(this, _React$Component.apply(this, arguments));\n\n    _this.onAnimateLeave = function () {\n      var afterClose = _this.props.afterClose;\n      // need demo?\n      // https://github.com/react-component/dialog/pull/28\n\n      if (_this.wrap) {\n        _this.wrap.style.display = 'none';\n      }\n      _this.inTransition = false;\n      _this.removeScrollingEffect();\n      if (afterClose) {\n        afterClose();\n      }\n    };\n    _this.onMaskClick = function (e) {\n      // android trigger click on open (fastclick??)\n      if (Date.now() - _this.openTime < 300) {\n        return;\n      }\n      if (e.target === e.currentTarget) {\n        _this.close(e);\n      }\n    };\n    _this.onKeyDown = function (e) {\n      var props = _this.props;\n      if (props.keyboard && e.keyCode === _KeyCode2.default.ESC) {\n        _this.close(e);\n      }\n      // keep focus inside dialog\n      if (props.visible) {\n        if (e.keyCode === _KeyCode2.default.TAB) {\n          var activeElement = document.activeElement;\n          var dialogRoot = _this.wrap;\n          if (e.shiftKey) {\n            if (activeElement === dialogRoot) {\n              _this.sentinel.focus();\n            }\n          } else if (activeElement === _this.sentinel) {\n            dialogRoot.focus();\n          }\n        }\n      }\n    };\n    _this.getDialogElement = function () {\n      var props = _this.props;\n      var closable = props.closable;\n      var prefixCls = props.prefixCls;\n      var dest = {};\n      if (props.width !== undefined) {\n        dest.width = props.width;\n      }\n      if (props.height !== undefined) {\n        dest.height = props.height;\n      }\n      var footer = void 0;\n      if (props.footer) {\n        footer = _react2.default.createElement(\"div\", { className: prefixCls + '-footer', ref: \"footer\" }, props.footer);\n      }\n      var header = void 0;\n      if (props.title) {\n        header = _react2.default.createElement(\"div\", { className: prefixCls + '-header', ref: \"header\" }, _react2.default.createElement(\"div\", { className: prefixCls + '-title', id: _this.titleId }, props.title));\n      }\n      var closer = void 0;\n      if (closable) {\n        closer = _react2.default.createElement(\"button\", { onClick: _this.close, \"aria-label\": \"Close\", className: prefixCls + '-close' }, _react2.default.createElement(\"span\", { className: prefixCls + '-close-x' }));\n      }\n      var style = (0, _objectAssign2.default)({}, props.style, dest);\n      var transitionName = _this.getTransitionName();\n      var dialogElement = _react2.default.createElement(_LazyRenderBox2.default, { key: \"dialog-element\", role: \"document\", ref: _this.saveRef('dialog'), style: style, className: prefixCls + ' ' + (props.className || ''), visible: props.visible }, _react2.default.createElement(\"div\", { className: prefixCls + '-content' }, closer, header, _react2.default.createElement(\"div\", (0, _extends3.default)({ className: prefixCls + '-body', style: props.bodyStyle, ref: \"body\" }, props.bodyProps), props.children), footer), _react2.default.createElement(\"div\", { tabIndex: 0, ref: _this.saveRef('sentinel'), style: { width: 0, height: 0, overflow: 'hidden' } }, \"sentinel\"));\n      return _react2.default.createElement(_rcAnimate2.default, { key: \"dialog\", showProp: \"visible\", onLeave: _this.onAnimateLeave, transitionName: transitionName, component: \"\", transitionAppear: true }, props.visible || !props.destroyOnClose ? dialogElement : null);\n    };\n    _this.getZIndexStyle = function () {\n      var style = {};\n      var props = _this.props;\n      if (props.zIndex !== undefined) {\n        style.zIndex = props.zIndex;\n      }\n      return style;\n    };\n    _this.getWrapStyle = function () {\n      return (0, _objectAssign2.default)({}, _this.getZIndexStyle(), _this.props.wrapStyle);\n    };\n    _this.getMaskStyle = function () {\n      return (0, _objectAssign2.default)({}, _this.getZIndexStyle(), _this.props.maskStyle);\n    };\n    _this.getMaskElement = function () {\n      var props = _this.props;\n      var maskElement = void 0;\n      if (props.mask) {\n        var maskTransition = _this.getMaskTransitionName();\n        maskElement = _react2.default.createElement(_LazyRenderBox2.default, (0, _extends3.default)({ style: _this.getMaskStyle(), key: \"mask\", className: props.prefixCls + '-mask', hiddenClassName: props.prefixCls + '-mask-hidden', visible: props.visible }, props.maskProps));\n        if (maskTransition) {\n          maskElement = _react2.default.createElement(_rcAnimate2.default, { key: \"mask\", showProp: \"visible\", transitionAppear: true, component: \"\", transitionName: maskTransition }, maskElement);\n        }\n      }\n      return maskElement;\n    };\n    _this.getMaskTransitionName = function () {\n      var props = _this.props;\n      var transitionName = props.maskTransitionName;\n      var animation = props.maskAnimation;\n      if (!transitionName && animation) {\n        transitionName = props.prefixCls + '-' + animation;\n      }\n      return transitionName;\n    };\n    _this.getTransitionName = function () {\n      var props = _this.props;\n      var transitionName = props.transitionName;\n      var animation = props.animation;\n      if (!transitionName && animation) {\n        transitionName = props.prefixCls + '-' + animation;\n      }\n      return transitionName;\n    };\n    _this.setScrollbar = function () {\n      if (_this.bodyIsOverflowing && _this.scrollbarWidth !== undefined) {\n        document.body.style.paddingRight = _this.scrollbarWidth + 'px';\n      }\n    };\n    _this.addScrollingEffect = function () {\n      openCount++;\n      if (openCount !== 1) {\n        return;\n      }\n      _this.checkScrollbar();\n      _this.setScrollbar();\n      document.body.style.overflow = 'hidden';\n      // this.adjustDialog();\n    };\n    _this.removeScrollingEffect = function () {\n      openCount--;\n      if (openCount !== 0) {\n        return;\n      }\n      document.body.style.overflow = '';\n      _this.resetScrollbar();\n      // this.resetAdjustments();\n    };\n    _this.close = function (e) {\n      var onClose = _this.props.onClose;\n\n      if (onClose) {\n        onClose(e);\n      }\n    };\n    _this.checkScrollbar = function () {\n      var fullWindowWidth = window.innerWidth;\n      if (!fullWindowWidth) {\n        var documentElementRect = document.documentElement.getBoundingClientRect();\n        fullWindowWidth = documentElementRect.right - Math.abs(documentElementRect.left);\n      }\n      _this.bodyIsOverflowing = document.body.clientWidth < fullWindowWidth;\n      if (_this.bodyIsOverflowing) {\n        _this.scrollbarWidth = (0, _getScrollBarSize2.default)();\n      }\n    };\n    _this.resetScrollbar = function () {\n      document.body.style.paddingRight = '';\n    };\n    _this.adjustDialog = function () {\n      if (_this.wrap && _this.scrollbarWidth !== undefined) {\n        var modalIsOverflowing = _this.wrap.scrollHeight > document.documentElement.clientHeight;\n        _this.wrap.style.paddingLeft = (!_this.bodyIsOverflowing && modalIsOverflowing ? _this.scrollbarWidth : '') + 'px';\n        _this.wrap.style.paddingRight = (_this.bodyIsOverflowing && !modalIsOverflowing ? _this.scrollbarWidth : '') + 'px';\n      }\n    };\n    _this.resetAdjustments = function () {\n      if (_this.wrap) {\n        _this.wrap.style.paddingLeft = _this.wrap.style.paddingLeft = '';\n      }\n    };\n    _this.saveRef = function (name) {\n      return function (node) {\n        _this[name] = node;\n      };\n    };\n    return _this;\n  }\n\n  Dialog.prototype.componentWillMount = function componentWillMount() {\n    this.inTransition = false;\n    this.titleId = 'rcDialogTitle' + uuid++;\n  };\n\n  Dialog.prototype.componentDidMount = function componentDidMount() {\n    this.componentDidUpdate({});\n  };\n\n  Dialog.prototype.componentDidUpdate = function componentDidUpdate(prevProps) {\n    var props = this.props;\n    var mousePosition = this.props.mousePosition;\n    if (props.visible) {\n      // first show\n      if (!prevProps.visible) {\n        this.openTime = Date.now();\n        this.lastOutSideFocusNode = document.activeElement;\n        this.addScrollingEffect();\n        this.wrap.focus();\n        var dialogNode = _reactDom2.default.findDOMNode(this.dialog);\n        if (mousePosition) {\n          var elOffset = offset(dialogNode);\n          setTransformOrigin(dialogNode, mousePosition.x - elOffset.left + 'px ' + (mousePosition.y - elOffset.top) + 'px');\n        } else {\n          setTransformOrigin(dialogNode, '');\n        }\n      }\n    } else if (prevProps.visible) {\n      this.inTransition = true;\n      if (props.mask && this.lastOutSideFocusNode) {\n        try {\n          this.lastOutSideFocusNode.focus();\n        } catch (e) {\n          this.lastOutSideFocusNode = null;\n        }\n        this.lastOutSideFocusNode = null;\n      }\n    }\n  };\n\n  Dialog.prototype.componentWillUnmount = function componentWillUnmount() {\n    if (this.props.visible || this.inTransition) {\n      this.removeScrollingEffect();\n    }\n  };\n\n  Dialog.prototype.render = function render() {\n    var props = this.props;\n    var prefixCls = props.prefixCls,\n        maskClosable = props.maskClosable;\n\n    var style = this.getWrapStyle();\n    // clear hide display\n    // and only set display after async anim, not here for hide\n    if (props.visible) {\n      style.display = null;\n    }\n    return _react2.default.createElement(\"div\", null, this.getMaskElement(), _react2.default.createElement(\"div\", (0, _extends3.default)({ tabIndex: -1, onKeyDown: this.onKeyDown, className: prefixCls + '-wrap ' + (props.wrapClassName || ''), ref: this.saveRef('wrap'), onClick: maskClosable ? this.onMaskClick : undefined, role: \"dialog\", \"aria-labelledby\": props.title ? this.titleId : null, style: style }, props.wrapProps), this.getDialogElement()));\n  };\n\n  return Dialog;\n}(_react2.default.Component);\n\nexports.default = Dialog;\n\n\nDialog.defaultProps = {\n  className: '',\n  mask: true,\n  visible: false,\n  keyboard: true,\n  closable: true,\n  maskClosable: true,\n  destroyOnClose: false,\n  prefixCls: 'rc-dialog'\n};"},"hash":"c4e664038b825be04c385d370f1e5d1c"}