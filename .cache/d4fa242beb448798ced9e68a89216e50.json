{"dependencies":[{"name":"react","loc":{"line":1,"column":18}},{"name":"react-dom","loc":{"line":2,"column":21}},{"name":"create-react-class","loc":{"line":3,"column":29}},{"name":"prop-types","loc":{"line":4,"column":22}},{"name":"rc-util/es/createChainedFunction","loc":{"line":5,"column":34}},{"name":"rc-util/es/KeyCode","loc":{"line":6,"column":20}},{"name":"./picker/placements","loc":{"line":7,"column":23}},{"name":"rc-trigger","loc":{"line":8,"column":20}}],"generated":{"js":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactDom = require(\"react-dom\");\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _createReactClass = require(\"create-react-class\");\n\nvar _createReactClass2 = _interopRequireDefault(_createReactClass);\n\nvar _propTypes = require(\"prop-types\");\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _createChainedFunction = require(\"rc-util/es/createChainedFunction\");\n\nvar _createChainedFunction2 = _interopRequireDefault(_createChainedFunction);\n\nvar _KeyCode = require(\"rc-util/es/KeyCode\");\n\nvar _KeyCode2 = _interopRequireDefault(_KeyCode);\n\nvar _placements = require(\"./picker/placements\");\n\nvar _placements2 = _interopRequireDefault(_placements);\n\nvar _rcTrigger = require(\"rc-trigger\");\n\nvar _rcTrigger2 = _interopRequireDefault(_rcTrigger);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction noop() {}\n\nfunction refFn(field, component) {\n  this[field] = component;\n}\n\nvar Picker = (0, _createReactClass2.default)({\n  displayName: 'Picker',\n\n  propTypes: {\n    animation: _propTypes2.default.oneOfType([_propTypes2.default.func, _propTypes2.default.string]),\n    disabled: _propTypes2.default.bool,\n    transitionName: _propTypes2.default.string,\n    onChange: _propTypes2.default.func,\n    onOpenChange: _propTypes2.default.func,\n    children: _propTypes2.default.func,\n    getCalendarContainer: _propTypes2.default.func,\n    calendar: _propTypes2.default.element,\n    style: _propTypes2.default.object,\n    open: _propTypes2.default.bool,\n    defaultOpen: _propTypes2.default.bool,\n    prefixCls: _propTypes2.default.string,\n    placement: _propTypes2.default.any,\n    value: _propTypes2.default.oneOfType([_propTypes2.default.object, _propTypes2.default.array]),\n    defaultValue: _propTypes2.default.oneOfType([_propTypes2.default.object, _propTypes2.default.array]),\n    align: _propTypes2.default.object\n  },\n\n  getDefaultProps: function getDefaultProps() {\n    return {\n      prefixCls: 'rc-calendar-picker',\n      style: {},\n      align: {},\n      placement: 'bottomLeft',\n      defaultOpen: false,\n      onChange: noop,\n      onOpenChange: noop\n    };\n  },\n  getInitialState: function getInitialState() {\n    var props = this.props;\n    var open = void 0;\n    if ('open' in props) {\n      open = props.open;\n    } else {\n      open = props.defaultOpen;\n    }\n    var value = props.value || props.defaultValue;\n    this.saveCalendarRef = refFn.bind(this, 'calendarInstance');\n    return {\n      open: open,\n      value: value\n    };\n  },\n  componentWillReceiveProps: function componentWillReceiveProps(nextProps) {\n    var value = nextProps.value,\n        open = nextProps.open;\n\n    if ('value' in nextProps) {\n      this.setState({\n        value: value\n      });\n    }\n    if (open !== undefined) {\n      this.setState({\n        open: open\n      });\n    }\n  },\n  componentDidUpdate: function componentDidUpdate(_, prevState) {\n    if (!prevState.open && this.state.open) {\n      // setTimeout is for making sure saveCalendarRef happen before focusCalendar\n      this.focusTimeout = setTimeout(this.focusCalendar, 0, this);\n    }\n  },\n  componentWillUnmount: function componentWillUnmount() {\n    clearTimeout(this.focusTimeout);\n  },\n  onCalendarKeyDown: function onCalendarKeyDown(event) {\n    if (event.keyCode === _KeyCode2.default.ESC) {\n      event.stopPropagation();\n      this.close(this.focus);\n    }\n  },\n  onCalendarSelect: function onCalendarSelect(value) {\n    var cause = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    var props = this.props;\n    if (!('value' in props)) {\n      this.setState({\n        value: value\n      });\n    }\n    if (cause.source === 'keyboard' || !props.calendar.props.timePicker && cause.source !== 'dateInput' || cause.source === 'todayButton') {\n      this.close(this.focus);\n    }\n    props.onChange(value);\n  },\n  onKeyDown: function onKeyDown(event) {\n    if (event.keyCode === _KeyCode2.default.DOWN && !this.state.open) {\n      this.open();\n      event.preventDefault();\n    }\n  },\n  onCalendarOk: function onCalendarOk() {\n    this.close(this.focus);\n  },\n  onCalendarClear: function onCalendarClear() {\n    this.close(this.focus);\n  },\n  onVisibleChange: function onVisibleChange(open) {\n    this.setOpen(open);\n  },\n  getCalendarElement: function getCalendarElement() {\n    var props = this.props;\n    var state = this.state;\n    var calendarProps = props.calendar.props;\n    var value = state.value;\n\n    var defaultValue = value;\n    var extraProps = {\n      ref: this.saveCalendarRef,\n      defaultValue: defaultValue || calendarProps.defaultValue,\n      selectedValue: value,\n      onKeyDown: this.onCalendarKeyDown,\n      onOk: (0, _createChainedFunction2.default)(calendarProps.onOk, this.onCalendarOk),\n      onSelect: (0, _createChainedFunction2.default)(calendarProps.onSelect, this.onCalendarSelect),\n      onClear: (0, _createChainedFunction2.default)(calendarProps.onClear, this.onCalendarClear)\n    };\n\n    return _react2.default.cloneElement(props.calendar, extraProps);\n  },\n  setOpen: function setOpen(open, callback) {\n    var onOpenChange = this.props.onOpenChange;\n\n    if (this.state.open !== open) {\n      if (!('open' in this.props)) {\n        this.setState({\n          open: open\n        }, callback);\n      }\n      onOpenChange(open);\n    }\n  },\n  open: function open(callback) {\n    this.setOpen(true, callback);\n  },\n  close: function close(callback) {\n    this.setOpen(false, callback);\n  },\n  focus: function focus() {\n    if (!this.state.open) {\n      _reactDom2.default.findDOMNode(this).focus();\n    }\n  },\n  focusCalendar: function focusCalendar() {\n    if (this.state.open && this.calendarInstance !== null) {\n      this.calendarInstance.focus();\n    }\n  },\n  render: function render() {\n    var props = this.props;\n    var prefixCls = props.prefixCls,\n        placement = props.placement,\n        style = props.style,\n        getCalendarContainer = props.getCalendarContainer,\n        align = props.align,\n        animation = props.animation,\n        disabled = props.disabled,\n        transitionName = props.transitionName,\n        children = props.children;\n\n    var state = this.state;\n    return _react2.default.createElement(_rcTrigger2.default, {\n      popup: this.getCalendarElement(),\n      popupAlign: align,\n      builtinPlacements: _placements2.default,\n      popupPlacement: placement,\n      action: disabled && !state.open ? [] : ['click'],\n      destroyPopupOnHide: true,\n      getPopupContainer: getCalendarContainer,\n      popupStyle: style,\n      popupAnimation: animation,\n      popupTransitionName: transitionName,\n      popupVisible: state.open,\n      onPopupVisibleChange: this.onVisibleChange,\n      prefixCls: prefixCls\n    }, _react2.default.cloneElement(children(state, props), { onKeyDown: this.onKeyDown }));\n  }\n});\n\nexports.default = Picker;"},"hash":"10629297c60c368e1a4b706c4b84421a"}